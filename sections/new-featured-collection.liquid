{{ 'featured-collection.css' | asset_url | stylesheet_tag }}
{{ 'featured-product-grid.css' | asset_url | stylesheet_tag }}

{%- liquid
  assign section_heading = section.settings.heading
  assign marker_style = section.settings.marker_style
  assign section_description = section.settings.description
  assign display_type = section.settings.display_type
  assign columns_desktop = section.settings.columns_desktop
  assign featured_collection = section.settings.collection
  assign show_view_all = section.settings.show_view_all
  assign product_limit = section.settings.product_limit
  assign mobile_swipe = section.settings.mobile_swipe
  assign show_progress_bar = section.settings.show_progress_bar
  assign marker_color = section.settings.marker_color
  assign disable_top_spacing = section.settings.disable_top_spacing
  assign disable_bottom_spacing = section.settings.disable_bottom_spacing

  assign columns_class = 'small-6 medium-6 large-4'
  case columns_desktop
    when 2
      assign columns_class = 'small-6 medium-6'
    when 3
      assign columns_class = 'small-6 medium-4'
    when 4
      assign columns_class = 'small-6 medium-6 large-3'
    when 5
      assign columns_class = 'small-6 medium-3 large-1/5'
    when 6
      assign columns_class = 'small-6 medium-3 large-2'
  endcase

  if featured_collection.all_products_count > product_limit
    assign more_in_collection = true
  endif

  if show_view_all and more_in_collection
    assign section_heading_button = featured_collection
  endif

  if display_type == 'carousel'
    assign element = 'slide-show'
  else
    assign element = 'div'
  endif
-%}

<style>
                .featured-collection-{{ section.id }}{
                  padding: 0;
                  margin: 100px 0 100px auto;
                  max-width: none;
                  padding-left: 8.33vw;
                }
                .featured-collection-{{ section.id }} .section-header--title {
                  font-size: 40px !important;
                  line-height: 38px;
             font-weight: 800;
                }
                .featured-collection-{{ section.id }} > .row {
                  padding: 0;
                  max-width: none;
                }

                .featured-collection-{{ section.id }} > .row .columns {
                  padding: 0;

                }
                .featured-collection-{{ section.id }} > .row .columns.carousel__slide{
                  flex: 0 0 {{section.settings.carousel_count}}%;
                  max-width: {{section.settings.carousel_count}}%;
                  height: 100%;
                }
                .featured-collection-{{ section.id }} product-card .product-card-info custom-automatic-discount-reminder {
                  width: auto !important;
                  margin-top: 12px;
                  margin-bottom: 0px;
                  border-radius: 0;
                  font-weight: 700;
                  padding: 0;
                  line-height: 1.5; /* 150% */
                  font-size: 16px;
                }
                .featured-collection-{{ section.id }} .product-card-price-and-button{
                  display: flex;
                  align-items: center;
                  justify-content: space-between;

                }
                .featured-collection-{{ section.id }}  .price {
                  display: inline-flex;
                  flex-direction: row-reverse !important;
                  line-height: 1;
                  gap: 12px;
              }

              .featured-collection-{{ section.id }} span.badge_ul:before {
                content: "";
                position: relative;
                background: none;
                top: 0;
                left: 0;
                z-index: -1;
                width: 0;
                height: 0;
                background-size: contain;
                display:none;
            }
              .featured-collection-{{ section.id }}  .price>del {

                min-width: max-content;
                color: #C2C2C2;
            }
            .featured-collection-{{ section.id }} .product-card .badge.top {
              top: 0;
              color: #fff;
              padding: 0;
              display: inline-flex;
              height: auto;
              padding: 10px 14px;
              align-items: center;
              gap: 5px;
              font-size: 14px;
              flex-shrink: 0;
              border-radius: 5px;
              background: linear-gradient(90deg, #FFBF00 -9.86%, #F10 51.87%, #FF00E0 115.74%);
              left: 0 !important;
              width: max-content;
          }
          .featured-collection-{{ section.id }}  .section-header {
            padding: 0;
            margin-bottom: 60px;
            margin-left: 0;
            margin-right: 8.33vw;
            max-width: none;
            align-items: start;
          }
          .featured-collection-{{ section.id }} .flickity-progress {
            display: block;
            width: 600px;
            height: 3px;
            background: #D9D9D9;
            border-radius: 0;
            position: relative;
            margin-top: 50px;
            margin-left: auto;
            margin-right: auto;
            opacity: 0;
        }
        .featured-collection-{{ section.id }}:hover .flickity-progress {
          opacity: 1;
        }
        .featured-collection-{{ section.id }}  .flickity-progress--bar {
          position: absolute;
          top: 0;
          left: 0;
          height: 3px;
          background: #000;
          width: 0%;
          border-radius: 0;
      }
      .featured-collection-{{ section.id }} .flickity-viewport {
        overflow: hidden;
        position: relative;
        height: auto !important;
        min-width: 100%;
        min-height: 630px;
    }
            @media only screen and (min-width: 768px) {
              .featured-collection-{{ section.id }} .product-card .badge.top {
                top: 0;
              }
            }
            .featured-collection-{{ section.id }} .product-card .badge.left {
              left: 0;
            }
            @media only screen and (min-width: 768px) {
              .featured-collection-{{ section.id }}  .product-card .badge.left {
                left: 0;
              }
            }
            @media print, screen and (max-width: 1600px){
              .featured-collection-{{ section.id }}{
                padding: 0;
                  margin: 100px 0 100px 8.33vw !important;
                max-width: none;
                padding-left: auto;
              }
              .featured-collection-{{ section.id }} > .row .columns.carousel__slide {
                {% if section.settings.carousel_count == '24.4' %}
                  flex: 0 0 32.6%;
                  max-width: 32.6%;
                {% elsif section.settings.carousel_count == '23.8' %}
                  flex: 0 0 31.8%;
                  max-width: 31.8%;
                {% elsif section.settings.carousel_count == '23.2' %}
                  flex: 0 0 30.3%;
                  max-width: 30.3%;

                {% endif %}
              }
            }


                .featured-collection-{{ section.id }} .product-card--content-spacing-true .product-featured-image {
                  padding: 0;
                }

                .featured-collection-{{ section.id }} product-card .product-card-info custom-automatic-discount-reminder {
                  margin-bottom: 10px;
                }
  @media screen and (max-width: 768px){
         .featured-collection-{{ section.id }}{
                padding: 0;
                  margin: 50px 0 50px 0 !important;
                max-width: none;
                padding-left: auto;
              }
    .featured-collection-{{ section.id }} .featured-collection {

      margin-left: 0 !important;
  }
    .featured-collection-{{ section.id }} .section-header--title {

      max-width: 100% !important;
      font-size: 24px !important;
  }
  }
                @media screen and (max-width: 749px) {
                  .featured-collection-{{ section.id }} > .row {
                    padding: 0 24px;
                    max-width: none;
                  }
                  .featured-collection-{{ section.id }} .flickity-viewport {
                    overflow: hidden;
                    position: relative;
                    height: auto !important;
                    min-width: 100%;
                    min-height: 539px;
                }
                  .featured-collection-{{ section.id }} .flickity-progress {
                    display: block;
                    width: auto;
                    height: 2px;
                    background: #D9D9D9;
                    border-radius: 0;
                    position: relative;
                    margin-top: 30px;
                    margin-left: auto;
                    margin-right: auto;
                    opacity: 1;
                }
                  .featured-collection-{{ section.id }}  .product-card .badge.top {
                    top: 0;
                    color: #fff;
                    padding: 0;
                    display: inline-flex;
                    height: auto;
                    padding: 10px 12px;
                    align-items: center;
                    gap: 5px;
                    font-size: 12px;
                    flex-shrink: 0;
                    border-radius: 5px;
                    background: linear-gradient(90deg, #FFBF00 -9.86%, #F10 51.87%, #FF00E0 115.74%);
                    left: 0 !important;
                    width: max-content;
                }
                  .featured-collection-{{ section.id }} > .row .columns.carousel__slide{
                    flex: 0 0 {{section.settings.carousel_count_mobile}}%;
                    max-width: {{section.settings.carousel_count_mobile}}%;
                    min-height: 478px;
                  }

                  .featured-collection-{{ section.id }} product-card .product-card-info custom-automatic-discount-reminder {
                    margin: 10px -20px;
                  }

                  .featured-collection-{{ section.id }} .section-header--button {
                    font-size: 14px !important;
                    color: #DA291C !important;
                    margin-bottom: 20px !important;
                  }

                  .featured-collection-{{ section.id }} .product-card--content-spacing-true .product-featured-image {
                    padding: 0;
                  }

                }
</style>
<div class="featured-collection-{{ section.id }} featured-collection{% if mobile_swipe %} swipe-on-mobile{% endif %} section-spacing{% if disable_top_spacing %} section-spacing--disable-top{% endif %}{% if disable_bottom_spacing %} section-spacing--disable-bottom{% endif %}">
  <div class="row">
    <div class="small-12 columns">
      {% render 'section-header',
        section_heading: section_heading,
        section_description: section_description,
        section_heading_button: section_heading_button,
        text_button_title: 'View All >>',
        marker_color: marker_color,
        marker_style: marker_style
      %}
      <div class="featured-collection__inner display-type--{{ display_type }}">
        <{{ element }} id="product-grid-{{ section.id }}" class="products row {{ display_type | append: '2' }}">
          {%- if featured_collection != blank -%}
            {%- for product in featured_collection.products limit: product_limit -%}
              <div class=" {{ columns_class }} columns {% if display_type == 'carousel' %}carousel__slide{% endif %}">
                {% render 'featured-product-card', product_card_product: product, enable_klarna: true %}
              </div>
            {%- endfor -%}
          {%- else -%}
            {%- for i in (1..product_limit) -%}
              <div class="{{ columns_class }} columns {% if display_type == 'carousel' %}carousel__slide{% endif %}">
                {% render 'featured-product-card' %}
              </div>
            {%- endfor -%}
          {%- endif -%}
          {%- if display_type == 'carousel' -%}
            {%- if product_limit > columns_desktop -%}
              <div class="carousel__slide_controls">
                <div class="flickity-nav flickity-prev" tabindex="0">
                  <svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 50 50" fill="none">
                    <circle cx="25" cy="25" r="25" transform="matrix(-1 0 0 1 50 0)" fill="black" fill-opacity="0.5"/>
                    <path d="M29.3477 18.4783C28.9672 18.8261 23.0297 22.6812 20.652 24.5652L28.2607 31.5217" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </div>
                <div class="flickity-nav flickity-next" tabindex="0">
                  <svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 50 50" fill="none">
                    <circle cx="25" cy="25" r="25" fill="black" fill-opacity="0.5"/>
                    <path d="M21.7393 17.9348C22.1197 18.2826 26.9702 22.6812 29.348 24.5652L21.7393 31.5217" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </div>
              </div>
            {%- endif -%}
          {%- endif -%}
        </{{ element }}>
        {%- if display_type == 'carousel' and show_progress_bar -%}
          <div class="flickity-progress">
            <div class="flickity-progress--bar"></div>
          </div>
        {%- endif -%}
      </div>
    </div>
  </div>
</div>

{% schema %}
{
  "name": "new Featured collection",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Featured Collection",
      "info": "Wrap your text between | to add animated markers. For example: Animated |marker| will underline marker text."
    },
    {
      "type": "select",
      "id": "marker_style",
      "options": [
        {
          "value": "style1",
          "label": "Basic"
        },
        {
          "value": "style2",
          "label": "Double"
        },
        {
          "value": "style3",
          "label": "Squiggle"
        },
        {
          "value": "style4",
          "label": "Zigzag"
        }
      ],
      "default": "style1",
      "label": "Marker"
    },
    {
      "type": "richtext",
      "id": "description",
      "label": "Description",
      "default": "<p>Describe your featured collection here</p>"
    },
    {
      "type": "header",
      "content": "Collection"
    },
    {
      "type": "collection",
      "id": "collection",
      "label": "Collection"
    },
    {
      "type": "select",
      "id": "display_type",
      "options": [
        {
          "value": "grid",
          "label": "Grid"
        },
        {
          "value": "carousel",
          "label": "Carousel"
        }
      ],
      "default": "grid",
      "label": "Display type"
    },
    {
      "type": "range",
      "id": "product_limit",
      "min": 2,
      "max": 12,
      "step": 1,
      "label": "Maximum products to show",
      "default": 4
    },
    {
      "type": "select",
      "id": "carousel_count",
      "label": "轮播显示数目",
      "options": [
        {
          "value": "25",
          "label": "4"
        },

        {
          "value": "24.4",
          "label": "4.1"
        },

        {
          "value": "23.8",
          "label": "4.2"
        },
        {
          "value": "23.2",
          "label": "4.3"
        },

        {
          "value": "33",
          "label": "3"
        },
        {
          "value": "32.6",
          "label": "3.1"
        },
        {
          "value": "32.2",
          "label": "3.2"
        },
        {
          "value": "31.8",
          "label": "3.3"
        },
        {
          "value": "50",
          "label": "2"
        }
      ],
      "default": "25",
      "info": "仅开启轮播时有效"
    },
    {
      "type": "select",
      "id": "carousel_count_mobile",
      "label": "轮播显示数目(手机端)",
      "options": [
        {
          "value": "91",
          "label": "1.1"
        },
        {
          "value": "83.33",
          "label": "1.2"
        },
        {
          "value": "76.92",
          "label": "1.3"
        },
        {
          "value": "50",
          "label": "2"
        },
        {
          "value": "47.6",
          "label": "2.1"
        },
        {
          "value": "45.45",
          "label": "2.2"
        },
        {
          "value": "43.2",
          "label": "2.3"
        }
      ],
      "default": "83.33",
      "info": "仅开启轮播时有效"
    },
    {
      "type": "range",
      "id": "columns_desktop",
      "min": 2,
      "max": 6,
      "step": 1,
      "default": 4,
      "label": "Number of columns on desktop"
    },
    {
      "type": "checkbox",
      "id": "show_view_all",
      "default": true,
      "label": "Enable \"View all\" button if collection has more products than shown"
    },
    {
      "type": "header",
      "content": "Grid"
    },
    {
      "type": "checkbox",
      "id": "mobile_swipe",
      "default": true,
      "label": "Enable swipe on mobile"
    },
    {
      "type": "header",
      "content": "Carousel"
    },
    {
      "type": "checkbox",
      "id": "show_progress_bar",
      "label": "Show progress bar",
      "default": true
    },
    {
      "type": "header",
      "content": "Colors"
    },
    {
      "type": "color",
      "id": "marker_color",
      "label": "Marker",
      "default": "#FD6262"
    },
    {
      "type": "header",
      "content": "Spacing"
    },
    {
      "type": "checkbox",
      "id": "disable_top_spacing",
      "default": false,
      "label": "Remove top spacing"
    },
    {
      "type": "checkbox",
      "id": "disable_bottom_spacing",
      "default": false,
      "label": "Remove bottom spacing"
    }
  ],
  "presets": [
    {
      "name": "new Featured collection"
    }
  ]
}
{% endschema %}
